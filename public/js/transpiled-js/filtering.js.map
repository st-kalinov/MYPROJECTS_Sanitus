{"version":3,"sources":["../filtering.js"],"names":["$","document","ready","mainCategorySlug","find","data","route","Routing","generate","slug","brandBlockClass","priceBlockClass","promotionBlockClass","paginationBlockClass","activePage","ionRangeSlider","type","min","max","from","to","postfix","grid","grid_num","hide_min_max","onFinish","val","makeAJAX","onUpdate","on","e","preventDefault","currentTarget","clear_filters","page","brand","get_filter","prices","promotion","console","log","ajax","url","method","contentType","JSON","stringify","price","beforeSend","show","success","hide","html","removeActivePageClass","setActivePageClass","error","className","inputType","values","each","index","element","push","removeClassFromElements","parentElement","classNameForRemove","removeClass","removeClassFromElement","elementNumber","classNameToAdd","addClass","prop","update"],"mappings":"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","file":"filtering.js","sourcesContent":["$(document).ready(function () {\r\n    const mainCategorySlug = $('#mainCatOptions').find('h2.main-category:first').data('slug');\r\n    const route = Routing.generate('app_products_maincategory_filtered', {slug: mainCategorySlug}, true);\r\n    const brandBlockClass = \"js-brand\";\r\n    const priceBlockClass = \"js-prices\";\r\n    const promotionBlockClass = \"js-promotion\";\r\n    const paginationBlockClass = \"js-pagination\";\r\n    var activePage = 1;\r\n    //-------------------------PRICE SLIDER ------------------------\r\n    $(\".js-range-slider\").ionRangeSlider({\r\n        type: \"double\",\r\n        min: 0,\r\n        max: 300,\r\n        from: 0,\r\n        to: 300,\r\n        postfix: 'лв.',\r\n        grid: true,\r\n        grid_num: 2,\r\n        hide_min_max: true,\r\n        onFinish: (data) => {\r\n            $('.js-price[name=\"minPrice\"]').val(data.from);\r\n            $('.js-price[name=\"maxPrice\"]').val(data.to);\r\n            activePage = 1;\r\n            makeAJAX();\r\n        },\r\n        onUpdate: (data) => {\r\n            $('.js-price[name=\"minPrice\"]').val(data.from);\r\n            $('.js-price[name=\"maxPrice\"]').val(data.to);\r\n            activePage = 1;\r\n            makeAJAX();\r\n        }\r\n    });\r\n    //--------------------PRICE SLIDER END---------------------------\r\n\r\n\r\n    $('#productFilterSection input:checkbox').on('click', () => {\r\n        activePage = 1;\r\n        makeAJAX();\r\n    });\r\n\r\n    $('body').on('click', `div.${paginationBlockClass} ul li`, (e) => {\r\n        e.preventDefault();\r\n        activePage = $(e.currentTarget).data(\"page\");\r\n        makeAJAX(activePage);\r\n\r\n    });\r\n\r\n    $('.clear-filters').on('click', () => {\r\n        clear_filters();\r\n    });\r\n\r\n    function makeAJAX(page = 1) {\r\n        let brand = get_filter(brandBlockClass, 'input:checkbox:checked');\r\n        let prices = get_filter(priceBlockClass, 'input');\r\n        let promotion = get_filter(promotionBlockClass, 'input:checkbox:checked');\r\n        console.log(prices);\r\n        $.ajax({\r\n            url: route,\r\n            method: 'POST',\r\n            contentType: 'application/json',\r\n            data: JSON.stringify({brand: brand, price: prices, promotion: promotion, page: page}),\r\n            beforeSend: () => {\r\n                $('.ajax-gif').show();\r\n            },\r\n            success: function (data) {\r\n                $('.ajax-gif').hide();\r\n                $('.products').html(data);\r\n                removeActivePageClass();\r\n                setActivePageClass(paginationBlockClass, \"ul li\", activePage,\"current-page\");\r\n            },\r\n            error: function () {\r\n                $('.ajax-gif').hide();\r\n            }\r\n        });\r\n    }\r\n\r\n    function get_filter(className, inputType) {\r\n        let values = [];\r\n        $(`.${className} ${inputType}`).each((index, element) => {\r\n            values.push($(element).val());\r\n        });\r\n\r\n        return values;\r\n    }\r\n\r\n    function removeClassFromElements(parentElement, element, classNameForRemove) {\r\n        $(`.${parentElement} ${element}`).each((index, element) => {\r\n           $(element).removeClass(classNameForRemove);\r\n        });\r\n    }\r\n\r\n    function removeClassFromElement(parentElement, element, classNameForRemove) {\r\n        $(`.${parentElement} ${element}`).removeClass(classNameForRemove);\r\n    }\r\n\r\n    function removeActivePageClass() {\r\n        removeClassFromElement(paginationBlockClass, \"ul li\", \"default-page\");\r\n        removeClassFromElements(paginationBlockClass, \"ul li\", \"current-page\");\r\n    }\r\n\r\n    function setActivePageClass(parentElement, element, elementNumber, classNameToAdd) {\r\n        $(`.${parentElement} ${element}`+':eq('+(elementNumber-1)+')').addClass(classNameToAdd);\r\n    }\r\n\r\n    function clear_filters() {\r\n        $('#productFilterSection input:checkbox').each((index, element) => {\r\n            $(element).prop('checked', false);\r\n        });\r\n        $(\".js-range-slider\").data('ionRangeSlider').update({from: 0, to: 300});\r\n    }\r\n\r\n});\r\n\r\n\r\n"]}